本日は、Rails応用課題６に取り組み、LGTMをもらった。

主にGem Punditの調査となった。

まず、Gemをbundle installする
そして、application_controller.rbに
```
include Pundit
```
と記載して、Punditモデルの機能を追加する。

そして、通常であればgeneratorを実行するが、カリキュラムのアプリは、すでに実行されていた。
```
docker compose exec web rails g pundit:install
```
すると、app/policies/配下に application_policy.rb というファイルが作成される。

生成されたapplication_policy.rbに次のように記述する。
```
class ApplicationPolicy
  attr_reader :user, :record

  def initialize(user, record)
    @user = user
    @record = record
  end

  def index?
    false
  end

  def update?
    false
  end

  def edit?
    update?
  end
end
```
ここで記述するアクションは、デフォルト値である。
この例で言うと、indexアクションの権限は、デフォルトではfalseとなる。
この例のedit?はupdate?と同じ権限であるという意味である。
編集画面を開くことができる人は、当然、更新する権限を持つということ。

そして各モデルのPolicyに
```
  def create?
    user.admin? || user.editor?
  end
```
と記載していく。
これは、このアクションの権限はadminとeditorであることを示している。

カリキュラムでは、ライターにカテゴリー、著者、タグの編集ページを表示させないと言う課題である。

この３つのPolicyは、すべて同じPolicyを継承している。
その継承元のPolicy名は忘れた（分類の英語）が、STIの仕組みに似ていると感じた。
つまり、継承元の権限設定をすれば、３つの権限を同時に設定できる。

明日は、Rails応用課題７に取り組みたいが、その前に、課題６の見直しをする。